<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced Assignment Cover Page</title>
    <!-- Include the html2canvas library for PNG export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
      :root {
        --font-multiplier: 1; /* CSS variable for easy font scaling */
      }
      @import url("https://fonts.googleapis.com/css2?family=Georgia&family=Roboto:wght@400;700&display=swap");

      body {
        background-color: #e9e9e9;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 30px 10px;
        font-family: "Georgia", "Times New Roman", serif;
      }

      .cover-page {
        background: white;
        width: 210mm;
        min-height: 256mm;
        padding: 1.5cm;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        box-sizing: border-box;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        border: 6px double #000;
        transition: all 0.2s ease-in-out;
      }

      .logo {
        width: 140px;
        height: auto;
        margin-bottom: 40px;
        transition: width 0.2s ease-in-out;
      }

      /* Typography scaled with CSS variable */
      .university-name {
        font-size: calc(26px * var(--font-multiplier));
        font-weight: bold;
        color: #1a1a1a;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }
      .faculty-name {
        font-size: calc(22px * var(--font-multiplier));
        font-weight: 600;
        color: #333;
        margin-bottom: 80px;
      }
      .course-title {
        font-size: calc(24px * var(--font-multiplier));
        font-weight: bold;
        color: #000;
        margin-bottom: 30px;
      }
      .assignment-no {
        font-size: calc(22px * var(--font-multiplier));
        font-weight: bold;
        color: #000;
        margin-bottom: 100px;
      }
      .submission-label {
        font-size: calc(16px * var(--font-multiplier));
        color: #555;
        margin-bottom: 15px;
      }
      .student-name {
        font-size: calc(20px * var(--font-multiplier));
        font-weight: 600;
        color: #000;
        margin-bottom: 40px;
      }
      .registration-label,
      .index-label {
        font-size: calc(16px * var(--font-multiplier));
        color: #555;
        margin-bottom: 15px;
      }
      .registration-no,
      .index-no {
        font-size: calc(18px * var(--font-multiplier));
        color: #000;
      }

      /* New section styling */
      .registration-section {
        margin-bottom: 40px;
      }
      .index-section {
        transition: opacity 0.3s, max-height 0.3s;
        overflow: hidden;
        max-height: 100px;
        opacity: 1;
      }
      .index-section.hidden {
        max-height: 0;
        opacity: 0;
        margin: 0;
      }

      [contenteditable="true"] {
        cursor: text;
        padding: 4px 8px;
        border-radius: 4px;
        transition: background-color 0.2s;
        outline: none;
        border-bottom: 2px solid transparent;
      }
      [contenteditable="true"]:hover {
        background-color: #f5f5f5;
      }
      [contenteditable="true"]:focus {
        background-color: #e8f0fe;
        border-bottom: 2px solid #007bff;
      }

      /* --- UI Styles --- */
      .ui-container {
        max-width: 210mm;
        width: 100%;
        box-sizing: border-box;
        font-family: "Roboto", sans-serif;
      }
      .instructions {
        background: #fff;
        border: 1px solid #ddd;
        padding: 15px 20px;
        margin-bottom: 15px;
        border-radius: 8px;
        font-size: 14px;
        color: #333;
      }
      .instructions h3 {
        margin-top: 0;
      }
      .instructions b {
        color: #0056b3;
      }
      .instructions p:last-child {
        font-style: italic;
        color: #555;
      }

      /* --- Customization Panel --- */
      .customization-panel {
        background: #fff;
        border: 1px solid #ddd;
        padding: 20px;
        margin-bottom: 20px;
        border-radius: 8px;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
      }
      .control-group {
        display: flex;
        flex-direction: column;
      }
      .control-group label {
        font-weight: bold;
        margin-bottom: 8px;
        font-size: 14px;
        color: #333;
      }
      .control-group select,
      .control-group .button-group button {
        font-family: "Roboto", sans-serif;
        font-size: 14px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .control-group .button-group {
        display: flex;
      }
      .control-group .button-group button {
        flex-grow: 1;
        cursor: pointer;
      }
      .control-group .button-group button:not(:last-child) {
        border-right: none;
      }
      .control-group .button-group button.active {
        background-color: #007bff;
        color: white;
        border-color: #007bff;
      }
      .logo-slider {
        width: 100%;
      }

      .button-container {
        display: flex;
        gap: 15px;
        margin-bottom: 30px;
      }
      .action-button {
        flex-grow: 1;
        padding: 15px;
        font-size: 16px;
        font-weight: bold;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s;
      }
      .pdf-button {
        background-color: #5cb85c;
      }
      .pdf-button:hover {
        background-color: #4cae4c;
      }
      .png-button {
        background-color: #007bff;
      }
      .png-button:hover {
        background-color: #0056b3;
      }

      @media print {
        body {
          background: white;
          padding: 0;
        }
        .ui-container {
          display: none;
        }
        .cover-page {
          box-shadow: none;
          width: 100%;
          min-height: 0;
          margin: 0;
          padding: 2cm;
        }
      }
      @media (max-width: 820px) {
        .cover-page {
          width: 100%;
          min-height: auto;
          padding: 1.5cm;
          height: auto;
        }
        body {
          padding: 0;
        }
        .ui-container {
          padding: 15px;
        }
      }
    </style>
  </head>
  <body>
    <div class="ui-container">
      <div class="instructions">
        <h3>Advanced Editable Cover Page</h3>
        <p>
          Use the controls to customize the look, edit the text, and click your
          desired export button.
        </p>
        <p>
          <b>Tip:</b> If you don't need the "Index No." field, just delete all
          the text inside it to make it disappear.
        </p>
      </div>

      <!-- Customization Panel -->
      <div class="customization-panel">
        <div class="control-group">
          <label for="font-family">Font Style</label>
          <select id="font-family">
            <option value="'Georgia', 'Times New Roman', serif"
              >Georgia (Classic)</option
            >
            <option value="'Times New Roman', Times, serif"
              >Times New Roman (Traditional)</option
            >
            <option value="Arial, sans-serif">Arial (Modern)</option>
          </select>
        </div>
        <div class="control-group">
          <label for="border-style">Border Style</label>
          <select id="border-style">
            <option value="6px double #000">Double Line</option>
            <option value="2px solid #000">Solid Line</option>
            <option value="3px dotted #333">Dotted Line</option>
            <option value="none">No Border</option>
          </select>
        </div>
        <div class="control-group">
          <label>Font Size</label>
          <div class="button-group" id="font-size-controls">
            <button data-scale="0.9">Smaller</button>
            <button data-scale="1.0" class="active">Default</button>
            <button data-scale="1.1">Larger</button>
          </div>
        </div>
        <div class="control-group">
          <label for="logo-size">Logo Size</label>
          <input
            type="range"
            id="logo-size"
            class="logo-slider"
            min="80"
            max="250"
            value="140"
          />
        </div>
      </div>

      <div class="button-container">
        <button class="action-button png-button" id="save-png-btn">
          Save as PNG
        </button>
        <button class="action-button pdf-button" onclick="window.print()">
          Save as PDF
        </button>
      </div>
    </div>

    <div class="cover-page" id="capture-area">
      <img src="rusl.png" alt="University Logo" class="logo" />
      <h1 class="university-name" contenteditable="true">
        Rajarata University of Sri Lanka
      </h1>
      <h2 class="faculty-name" contenteditable="true">
        Faculty of Social Science and Humanites
      </h2>
      <p class="course-title" contenteditable="true">
        Basic Mathematics (MATH 11012)
      </p>
      <p class="assignment-no" contenteditable="true">Assignment No. â€“ 01</p>
      <p class="submission-label">Submitted by:</p>
      <p class="student-name" contenteditable="true">
        Y.M. Nadeeja Madurajeewani Yapa
      </p>

      <!-- Updated Registration and New Index Sections -->
      <div class="registration-section">
        <p class="registration-label">Registration No.</p>
        <p class="registration-no" contenteditable="true">SSH/2024/464</p>
      </div>

      <div class="index-section" id="index-number-section">
        <p class="index-label">Index No.</p>
        <p class="index-no" contenteditable="true">12345678</p>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const coverPage = document.getElementById("capture-area");
        const logo = coverPage.querySelector(".logo");

        // --- Customization Controls ---
        const fontFamilySelect = document.getElementById("font-family");
        fontFamilySelect.addEventListener(
          "change",
          () => (coverPage.style.fontFamily = fontFamilySelect.value)
        );

        const borderStyleSelect = document.getElementById("border-style");
        borderStyleSelect.addEventListener(
          "change",
          () => (coverPage.style.border = borderStyleSelect.value)
        );

        const logoSizeSlider = document.getElementById("logo-size");
        logoSizeSlider.addEventListener(
          "input",
          () => (logo.style.width = logoSizeSlider.value + "px")
        );

        const fontSizeControls = document.getElementById("font-size-controls");
        fontSizeControls.addEventListener("click", (e) => {
          if (e.target.tagName === "BUTTON") {
            fontSizeControls
              .querySelector(".active")
              .classList.remove("active");
            e.target.classList.add("active");
            document.documentElement.style.setProperty(
              "--font-multiplier",
              e.target.getAttribute("data-scale")
            );
          }
        });

        // --- Smart Placeholder for Index Number ---
        const indexSection = document.getElementById("index-number-section");
        const indexInput = indexSection.querySelector(".index-no");

        const checkIndexVisibility = () => {
          if (indexInput.textContent.trim() === "") {
            indexSection.classList.add("hidden");
          } else {
            indexSection.classList.remove("hidden");
          }
        };

        indexInput.addEventListener("input", checkIndexVisibility);
        // Initial check in case the default is empty
        checkIndexVisibility();

        // --- PNG Export Functionality ---
        const savePngButton = document.getElementById("save-png-btn");
        savePngButton.addEventListener("click", function () {
          this.textContent = "Generating...";
          this.disabled = true;

          html2canvas(coverPage, {
            scale: 2,
            useCORS: true,
            logging: false,
            onclone: (doc) => {
              const activeElement = doc.querySelector(
                '[contenteditable="true"]:focus'
              );
              if (activeElement) activeElement.blur();
            },
          })
            .then((canvas) => {
              const link = document.createElement("a");
              link.download = "cover-page.png";
              link.href = canvas.toDataURL("image/png");
              link.click();
            })
            .finally(() => {
              this.textContent = "Save as PNG";
              this.disabled = false;
            });
        });
      });
    </script>
  </body>
</html>
